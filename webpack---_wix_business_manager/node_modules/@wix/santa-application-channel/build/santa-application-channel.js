!function(t,n){"object"==typeof exports&&"object"==typeof module?module.exports=n():"function"==typeof define&&define.amd?define([],n):"object"==typeof exports?exports.santaApplicationChannel=n():t.santaApplicationChannel=n()}(self,(function(){return(()=>{"use strict";var t={261:t=>{t.exports={ERROR_MESSAGES:{NO_TARGET_WINDOW:"targetWindow is Mandatory parameter",NO_APP_DEFINITION_ID:"appDefinitionId is Mandatory parameter",NO_CALLBACK:"callback is Mandatory parameter"},MESSAGE_TYPE:{OPEN_MESSAGE_CHANNEL:"openMessageChannel",SANTA_READY:"santaReady",SANTA_PAGE_CHANGE:"santaPageChange"},MESSAGE_INTENT:{SANTA_APPLICATION_CHANNEL_MESSAGE_RESPONSE:"SANTA_APPLICATION_CHANNEL_MESSAGE_RESPONSE",SANTA_APPLICATION_CHANNEL_MESSAGE:"SANTA_APPLICATION_CHANNEL_MESSAGE"}}},122:(t,n,e)=>{function a(t,n){(null==n||n>t.length)&&(n=t.length);for(var e=0,a=new Array(n);e<n;e++)a[e]=t[e];return a}var r=e(261),o={},i=[],c=[],E=!1,A={},f=function(t,n,e){if(A[n]){if(A[n].port)return void t(A[n].port);if(A[n].requestInProcess)return void A[n].callbacks.push(t)}A[n]={requestInProcess:!0,callbacks:[]},u((function(){var a,i="".concat((a=function(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)})()+a(),"-").concat(a(),"-").concat(a(),"-").concat(a(),"-").concat(a()).concat(a()).concat(a());o[i]=t,e.contentWindow.postMessage({intent:r.MESSAGE_INTENT.SANTA_APPLICATION_CHANNEL_MESSAGE,type:r.MESSAGE_TYPE.OPEN_MESSAGE_CHANNEL,appDefinitionId:n,callbackId:i},"*")}))};function u(t){E?t():i.push(t)}window.addEventListener("message",(function(t){if(t.data.intent===r.MESSAGE_INTENT.SANTA_APPLICATION_CHANNEL_MESSAGE_RESPONSE)switch(t.data.type){case r.MESSAGE_TYPE.OPEN_MESSAGE_CHANNEL:if(t.data&&t.data.callbackId&&o[t.data.callbackId]){if(t.data.error)o[t.data.callbackId](null,t.data.error),A[t.data.appDefinitionId].callbacks.forEach((function(n){n(null,t.data.error)}));else{var n=t.ports[0];A[t.data.appDefinitionId].port=n,A[t.data.appDefinitionId].callbacks.forEach((function(t){t(n)})),o[t.data.callbackId](n)}delete o[t.data.callbackId],A[t.data.appDefinitionId].requestInProcess=!1,A[t.data.appDefinitionId].callbacks=[]}break;case r.MESSAGE_TYPE.SANTA_READY:E=!0,i.forEach((function(t){t()})),i=[];break;case r.MESSAGE_TYPE.SANTA_PAGE_CHANGE:A={},c.forEach((function(t){f(t.cb,t.appDefinitionId,t.targetWindow)}))}})),t.exports={getAppPort:function(t,n){return new Promise((function(e,a){t?n?f((function(t,n){n?a(n):e(t)}),n,t):a(r.ERROR_MESSAGES.NO_APP_DEFINITION_ID):a(r.ERROR_MESSAGES.NO_TARGET_WINDOW)}))},listenToAppPortChange:function(t,n,e){if(e){var o=function(t,n){e(n||t)};t?n?(function(t){new MutationObserver((function(t){var n,e=function(t,n){var e;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(e=function(t,n){if(t){if("string"==typeof t)return a(t,n);var e=Object.prototype.toString.call(t).slice(8,-1);return"Object"===e&&t.constructor&&(e=t.constructor.name),"Map"===e||"Set"===e?Array.from(t):"Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e)?a(t,n):void 0}}(t))||n&&t&&"number"==typeof t.length){e&&(t=e);var r=0,o=function(){};return{s:o,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,c=!0,E=!1;return{s:function(){e=t[Symbol.iterator]()},n:function(){var t=e.next();return c=t.done,t},e:function(t){E=!0,i=t},f:function(){try{c||null==e.return||e.return()}finally{if(E)throw i}}}}(t);try{for(e.s();!(n=e.n()).done;){var r=n.value;"attributes"===r.type&&"src"===r.attributeName&&(A={},E=!1,u((function(){c.forEach((function(t){f(t.cb,t.appDefinitionId,t.targetWindow)}))})))}}catch(t){e.e(t)}finally{e.f()}})).observe(t,{attributes:!0})}(t),u((function(){c.push({cb:o,appDefinitionId:n,targetWindow:t})}))):e({error:r.ERROR_MESSAGES.NO_APP_DEFINITION_ID}):e({error:r.ERROR_MESSAGES.NO_TARGET_WINDOW})}else console.error(r.ERROR_MESSAGES.NO_CALLBACK)},clearAppPort:function(t){delete A[t],E=!1}}}},n={};return function e(a){if(n[a])return n[a].exports;var r=n[a]={exports:{}};return t[a](r,r.exports,e),r.exports}(122)})()}));
//# sourceMappingURL=santa-application-channel.js.map